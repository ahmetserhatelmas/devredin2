<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Devren Ä°lanlarÄ± - DevredinPlatform</title>
    <link rel="stylesheet" href="styles.css?v=5">
    <link rel="stylesheet" href="listings.css?v=5">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap" rel="stylesheet">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar" id="navbar">
        <div class="container">
            <div class="nav-wrapper">
                <div class="logo">
                    <a href="index.html">devredin<span>platform</span></a>
                </div>
                <ul class="nav-menu" id="navMenu">
                    <li><a href="index.html" class="nav-link">Ana Sayfa</a></li>
                    <li><a href="listings.html" class="nav-link active">Ä°ÅŸletme Devral</a></li>
                    <li><a href="add-listing.html" class="nav-link">Ä°ÅŸletmeni Devret</a></li>
                    <li><a href="index.html#about" class="nav-link">NasÄ±l Ã‡alÄ±ÅŸÄ±r</a></li>
                    <li><a href="index.html#contact" class="nav-link">Ä°letiÅŸim</a></li>
                </ul>
                <div class="nav-buttons">
                    <!-- YÃ¼kleniyor -->
                    <div id="navLoading" style="display: flex; gap: 1rem; align-items: center;">
                        <span style="color: #94a3b8; font-size: 0.9rem;">â³</span>
                    </div>
                    
                    <!-- GiriÅŸ YapmamÄ±ÅŸ -->
                    <div id="loggedOutButtons" style="display: none; gap: 1rem;">
                        <a href="login.html" class="btn btn-outline">GiriÅŸ Yap</a>
                        <a href="add-listing.html" class="btn btn-primary">Ä°lan Ver</a>
                    </div>
                    
                    <!-- GiriÅŸ YapmÄ±ÅŸ -->
                    <div id="loggedInButtons" style="display: none; align-items: center; gap: 1rem;">
                        <a href="profile.html" class="btn btn-profile" id="userName">ğŸ‘¤ Profilim</a>
                        <a href="add-listing.html" class="btn btn-primary">Ä°lan Ver</a>
                        <button onclick="handleLogout()" class="btn btn-outline">Ã‡Ä±kÄ±ÅŸ</button>
                    </div>
                </div>
                <div class="hamburger" id="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Page Header -->
    <section class="page-header">
        <div class="container">
            <div class="breadcrumb">
                <a href="index.html">Ana Sayfa</a> / <span>Ä°lanlar</span>
            </div>
            <h1>Devren Ä°lanlarÄ±</h1>
            <p>Toplam Ä°lan SayÄ±sÄ±: <strong id="totalListingCount">0</strong></p>
        </div>
    </section>

    <!-- Listings Section -->
    <section class="listings-section">
        <div class="container">
            <div class="listings-layout">
                <!-- Filters Sidebar -->
                <aside class="filters-sidebar">
                    <div class="filters-header">
                        <h3>Filtreler</h3>
                        <button class="clear-filters">Temizle</button>
                    </div>

                    <!-- Location Filter -->
                    <div class="filter-group">
                        <button class="filter-toggle">
                            <span>ğŸ“ Åehir</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content" id="cityFilterContent">
                            <!-- Åehirler dinamik yÃ¼klenecek -->
                            <select id="cityFilter" class="filter-select" style="width: 100%; padding: 0.8rem; border: 1px solid #e2e8f0; border-radius: 8px;">
                                <option value="">TÃ¼m Åehirler</option>
                            </select>
                        </div>
                    </div>

                    <!-- Category Filter (Ana Kategoriler) -->
                    <div class="filter-group">
                        <button class="filter-toggle">
                            <span>ğŸ“ Kategori</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content" id="categoryFilterContent">
                            <!-- Kategoriler dinamik yÃ¼klenecek -->
                            <p style="color: #94a3b8;">YÃ¼kleniyor...</p>
                        </div>
                    </div>

                    <!-- Subcategory Filter (SektÃ¶rler) -->
                    <div class="filter-group" id="subcategoryFilterGroup" style="display: none;">
                        <button class="filter-toggle">
                            <span>ğŸª SektÃ¶r</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content" id="subcategoryFilterContent">
                            <!-- SektÃ¶rler kategori seÃ§ildiÄŸinde yÃ¼klenecek -->
                            <p style="color: #94a3b8;">Ã–nce kategori seÃ§in</p>
                        </div>
                    </div>

                    <!-- Price Filter -->
                    <div class="filter-group">
                        <button class="filter-toggle">
                            <span>ğŸ’° Fiyat</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content">
                            <div class="price-inputs">
                                <input type="number" placeholder="Min â‚º" class="price-input" id="minPrice">
                                <span>-</span>
                                <input type="number" placeholder="Max â‚º" class="price-input" id="maxPrice">
                            </div>
                        </div>
                    </div>

                    <!-- Area Filter -->
                    <div class="filter-group">
                        <button class="filter-toggle">
                            <span>ğŸ“ Metrekare</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content">
                            <div class="price-inputs">
                                <input type="number" placeholder="Min mÂ²" class="price-input" id="minArea">
                                <span>-</span>
                                <input type="number" placeholder="Max mÂ²" class="price-input" id="maxArea">
                            </div>
                        </div>
                    </div>

                    <!-- Development Filter -->
                    <div class="filter-group">
                        <button class="filter-toggle">
                            <span>âš™ï¸ GeliÅŸmiÅŸ</span>
                            <span class="toggle-icon">âˆ’</span>
                        </button>
                        <div class="filter-content">
                            <label class="checkbox-label">
                                <input type="checkbox" name="feature" value="franchise">
                                <span>Franchise</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="feature" value="established">
                                <span>KÃ¶klÃ¼ Ä°ÅŸletme</span>
                            </label>
                            <label class="checkbox-label">
                                <input type="checkbox" name="feature" value="profitable">
                                <span>KÃ¢rlÄ±</span>
                            </label>
                        </div>
                    </div>

                    <button class="btn btn-primary" id="filterButton" style="width: 100%; margin-top: 1rem;">Filtrele</button>
                </aside>

                <!-- Main Content -->
                <main class="listings-main">
                    <!-- Search and Sort Bar -->
                    <div class="search-sort-bar">
                        <div class="search-bar-compact">
                            <span style="font-size: 1.2rem;">ğŸ”</span>
                            <input type="text" placeholder="Ä°lan baÅŸlÄ±ÄŸÄ±, ID, ÅŸehir, ilÃ§e, sektÃ¶r ile ara...">
                            <button class="btn btn-search-compact">Ara</button>
                        </div>
                        <div class="sort-controls">
                            <label>SÄ±rala:</label>
                            <select class="sort-select">
                                <option value="newest">Tarih (Ã–nce Yeni)</option>
                                <option value="oldest">Tarih (Ã–nce Eski)</option>
                                <option value="price-high">Fiyat (YÃ¼ksekten DÃ¼ÅŸÃ¼ÄŸe)</option>
                                <option value="price-low">Fiyat (DÃ¼ÅŸÃ¼kten YÃ¼kseÄŸe)</option>
                                <option value="area-high">Metrekare (BÃ¼yÃ¼kten KÃ¼Ã§Ã¼ÄŸe)</option>
                            </select>
                        </div>
                    </div>

                    <!-- View Toggle -->
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="grid">âŠ</button>
                        <button class="view-btn" data-view="list">â˜°</button>
                        <button class="view-btn" data-view="map">ğŸ“ Harita</button>
                    </div>

                    <!-- Listings Grid -->
                    <div class="listings-grid" id="listingsGrid">
                        <!-- Ä°lanlar dinamik olarak yÃ¼klenecek -->
                        <div style="grid-column: 1/-1; text-align: center; padding: 3rem;">
                            <p style="font-size: 1.2rem; color: #64748b;">â³ Ä°lanlar yÃ¼kleniyor...</p>
                        </div>
                    </div>

                    <!-- Pagination -->
                    <div class="pagination">
                        <!-- Sayfalama dinamik olarak oluÅŸturulacak -->
                    </div>
                </main>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <h3>devredinplatform</h3>
                    <p>TÃ¼rkiye'nin en bÃ¼yÃ¼k iÅŸletme devir platformu</p>
                </div>
                <div class="footer-section">
                    <h4>Devredin</h4>
                    <ul>
                        <li><a href="#">HakkÄ±mÄ±zda</a></li>
                        <li><a href="#">Bize UlaÅŸÄ±n</a></li>
                        <li><a href="#">Ä°ÅŸlem Rehberi</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>Ä°ÅŸletme Devral</h4>
                    <ul>
                        <li><a href="#">Devren KiralÄ±k Ä°lanlar</a></li>
                        <li><a href="#">Franchise Bul</a></li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>Copyright Â© 2025 Devredin Bilgi Teknolojileri. TÃ¼m HaklarÄ± SaklÄ±dÄ±r.</p>
            </div>
        </div>
    </footer>

    <!-- Supabase JS -->
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    
    <!-- Backend API -->
    <script src="backend/api.js?v=5"></script>
    
    <script src="script.js?v=5"></script>
    <script src="listings.js?v=5"></script>
    
    <script>
        // KullanÄ±cÄ± durumunu kontrol et
        document.addEventListener('DOMContentLoaded', async () => {
            await checkUserStatus()
        })
        
        async function checkUserStatus() {
            const user = await getCurrentUser()
            
            const navLoading = document.getElementById('navLoading')
            const loggedOut = document.getElementById('loggedOutButtons')
            const loggedIn = document.getElementById('loggedInButtons')
            const userName = document.getElementById('userName')
            
            // YÃ¼kleme gÃ¶stergesini gizle
            if (navLoading) navLoading.style.display = 'none'
            
            if (user) {
                loggedOut.style.display = 'none'
                loggedIn.style.display = 'flex'
                
                const { data: profile } = await supabase
                    .from('users')
                    .select('full_name')
                    .eq('id', user.id)
                    .single()
                
                if (profile && profile.full_name) {
                    userName.textContent = `ğŸ‘¤ ${profile.full_name.split(' ')[0]}`
                } else {
                    userName.textContent = `ğŸ‘¤ Profilim`
                }
            } else {
                loggedOut.style.display = 'flex'
                loggedIn.style.display = 'none'
            }
        }
        
        async function handleLogout() {
            if (confirm('Ã‡Ä±kÄ±ÅŸ yapmak istediÄŸinize emin misiniz?')) {
                await logoutUser()
                window.location.href = 'index.html'
            }
        }
    </script>
</body>
</html>

